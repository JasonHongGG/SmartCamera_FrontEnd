# 權限系統測試指南

## 🎯 測試目標
驗證 ImageViewer 中的圖片下載和刪除功能的權限控制是否正常運作。

## 📋 測試用戶

### 1. 管理員用戶 (aini)
- **帳號**: `aini`
- **密碼**: `0000`
- **角色**: `admin`
- **權限**: 擁有所有權限
  - ✅ 可以下載圖片 (`images.download`)
  - ✅ 可以刪除圖片 (`images.delete`)

### 2. 一般用戶 (selab)
- **帳號**: `selab`
- **密碼**: `1234`
- **角色**: `user`
- **權限**: 僅部分權限
  - ✅ 可以下載圖片 (`images.download`)
  - ❌ **不能**刪除圖片 (無 `images.delete` 權限)

## 🧪 測試步驟

### 測試 1: 管理員用戶 (aini) - 完整權限

1. **登入**
   ```
   帳號: aini
   密碼: 0000
   ```

2. **前往圖片瀏覽頁面**
   - 點擊導航欄的 "圖片瀏覽" 或 "Image Viewer"

3. **測試下載功能**
   - 點擊任一圖片的「下載」按鈕（綠色，Download 圖示）
   - ✅ **預期結果**: 圖片應該立即開始下載，不會出現權限提示

4. **測試刪除功能**
   - 點擊任一圖片的「刪除」按鈕（紅色，Trash2 圖示）
   - 系統會彈出確認對話框：「確定要刪除圖片嗎？」
   - 點擊「確定」
   - ✅ **預期結果**: 圖片應該被成功刪除，不會出現權限提示

### 測試 2: 一般用戶 (selab) - 受限權限

1. **登出管理員**
   - 點擊右上角用戶圖示
   - 點擊「登出」

2. **登入一般用戶**
   ```
   帳號: selab
   密碼: 1234
   ```

3. **前往圖片瀏覽頁面**
   - 點擊導航欄的 "圖片瀏覽" 或 "Image Viewer"

4. **測試下載功能**
   - 點擊任一圖片的「下載」按鈕
   - ✅ **預期結果**: 圖片應該立即開始下載，不會出現權限提示
   - 👉 selab 用戶有下載權限

5. **測試刪除功能** ⚠️ 重點測試
   - 點擊任一圖片的「刪除」按鈕
   - ❌ **預期結果**: 應該出現權限不足對話框
   - 對話框內容：
     ```
     權限不足
     您沒有權限執行此操作
     請聯絡管理員獲取相關權限。
     [我知道了]
     ```
   - 👉 點擊「我知道了」關閉對話框
   - 👉 圖片**不應該**被刪除

## 🎨 UI 測試重點

### 下載按鈕
- **Grid 檢視模式**:
  - 位置: 圖片卡片底部，綠色按鈕
  - 圖示: Download icon
  - 文字: "下載"

- **List 檢視模式**:
  - 位置: 每個圖片列表項目的右側
  - 圖示: Download icon (小型)
  - 背景: `bg-slate-600/50`

### 刪除按鈕
- **Grid 檢視模式**:
  - 位置: 圖片卡片底部，紅色按鈕
  - 圖示: Trash2 icon
  - 文字: "刪除"

- **List 檢視模式**:
  - 位置: 每個圖片列表項目的右側
  - 圖示: Trash2 icon (小型)
  - 背景: `bg-red-600/50`

### 權限不足對話框
- **外觀**:
  - 深色半透明背景遮罩
  - 白色對話框，圓角設計
  - 紅色警告圖示 (AlertTriangle)
  - 漸變標題背景 (紅色系)
  
- **互動**:
  - 點擊背景可關閉
  - 點擊「我知道了」按鈕關閉
  - 點擊 ESC 鍵關閉

## 📊 測試檢查表

| 測試項目 | 用戶 | 功能 | 預期結果 | 實際結果 | 通過 |
|---------|------|------|---------|---------|------|
| 1 | aini | 下載圖片 | 成功下載 | | ☐ |
| 2 | aini | 刪除圖片 | 成功刪除 | | ☐ |
| 3 | selab | 下載圖片 | 成功下載 | | ☐ |
| 4 | selab | 刪除圖片 | 顯示權限不足 | | ☐ |
| 5 | selab | 關閉權限對話框 | 對話框正常關閉 | | ☐ |
| 6 | - | UI 響應式 | 按鈕在不同螢幕大小正常顯示 | | ☐ |

## 🔍 除錯提示

如果測試失敗，請檢查：

1. **瀏覽器控制台**
   - 打開開發者工具 (F12)
   - 查看 Console 標籤是否有錯誤訊息
   - 檢查 Network 標籤的 API 請求

2. **用戶權限配置**
   - 檢查 `public/user.json` 檔案
   - 確認 selab 用戶的 `permissions.images.delete` 為 `false`
   - 確認 aini 用戶的 `permissions.images.delete` 為 `true`

3. **LocalStorage**
   - 在開發者工具的 Application > Local Storage
   - 查看 `user` 項目，確認當前登入用戶資訊正確

4. **重新登入**
   - 如果權限配置有變更，請先登出再重新登入
   - 清除瀏覽器快取後重試

## 🎯 成功標準

所有以下條件都應該滿足：

✅ aini 用戶可以順利下載和刪除圖片  
✅ selab 用戶可以下載圖片  
❌ selab 用戶無法刪除圖片，並看到權限不足提示  
✅ 權限對話框外觀和互動正常  
✅ 所有按鈕在不同檢視模式下都能正常顯示  
✅ 無 JavaScript 錯誤出現在控制台

## 📝 其他注意事項

- 刪除操作有確認對話框，只有在確認後才會檢查權限
- 下載功能會先載入完整尺寸圖片，然後才執行下載
- 在 Grid 和 List 兩種檢視模式下都要測試
- 測試響應式設計：在不同螢幕尺寸下測試（桌面、平板、手機）
